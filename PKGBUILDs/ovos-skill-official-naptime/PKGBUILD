_gh_org=OpenVoiceOS
_gh_proj=skill-ovos-naptime
pkgname=ovos-skill-official-naptime
_name=skill-ovos-naptime
_commit='13396584cf146abecf1a4cfe902fe95a4388ee65'
pkgver='0.3.9'
pkgrel=00
pkgdesc='Tell me to sleep when you don'\''t want
to be disturbed in any way. This stops all
calls to Speech to Text system, guaranteeing
your voice won'\''t be sent anywhere on an
accidental activation.'
arch=('any')
url='https://github.com/OpenVoiceOS/skill-ovos-naptime/'
license=('Apache License 2.0')
depends=(python
)
conflicts=()
makedepends=(python-build python-installer python-wheel python-setuptools)
provides=("$pkgname")
conflicts+=("$pkgname")

#### Automatically generated dependencies. Do not edit.
depends+=(
'python-ovos-bus-client>=0.0.8' # ovos-bus-client<2.0.0,>=0.0.8
'python-ovos-utils>=0.0.38' # ovos-utils>=0.0.38
'python-ovos-workshop>=0.0.15' # ovos-workshop<4.0.0,>=0.0.15
)
conflicts+=(
'python-ovos-bus-client>=2.0.0' # ovos-bus-client<2.0.0,>=0.0.8
'python-ovos-workshop>=4.0.0' # ovos-workshop<4.0.0,>=0.0.15
)
optdepends+=(

)

#### End of automatically generated dependencies.
source=("https://github.com/$_gh_org/$_gh_proj/archive/$_commit.tar.gz")
sha256sums=('0556831375fc1133f040a214d2ca99c80ba6bdcddf816e53551fa2abaac7db45')

prepare() {
    cd "$srcdir"
    for patch in "../"*.patch; do
        if [ -f "$patch" ]; then
          echo "Applying patch $patch"
          patch --forward --strip=1 --input="${PWD}/${patch}" --directory="${srcdir}/${_name}-${_commit}"
        fi
    done
}

pkgver(){
    cd "$srcdir/$_name-$_commit"
    echo "$(python setup.py --version)"
}

build() {
    cd "$_name-$_commit"
    python -m build --wheel --no-isolation
}

check() {
    cd "$_name-$_commit"

    local site_packages=$(python -c "import site; print(site.getsitepackages()[0])")
    local python_version=$(python -c 'import sys; print(".".join(map(str, sys.version_info[:2])))')

    # nosetests
    # pytest
}

package() {
    cd "$_name-$_commit"

    echo "Installing $pkgname to $pkgdir"
    # some packages produce multiple wheels, install the one specific to the version of the package
    python -m installer --destdir="$pkgdir" dist/*$pkgver*.whl

    # Optional: Copy documentation files
    if [ -d "$srcdir/$pkgname/docs" ]; then
        mkdir -p "$pkgdir/usr/share/doc/$pkgname"  # Create doc directory
        cp -r "$srcdir/$pkgname/docs" "$pkgdir/usr/share/doc/$pkgname" || true
        chmod 644 "$pkgdir/usr/share/doc/$pkgname"/*.txt  || true # Set read permissions for documentation files
    fi
    
    # Optional: Remove unused files or directories
    # For example, removing unneeded binaries, license files, etc.
    # rm "$pkgdir/usr/bin/unneeded_binary"  # Remove unneeded binary
    # rm "$pkgdir/usr/share/doc/$pkgname/unneeded_license.txt"  # Remove unneeded license file

    # Search for license files in the original source directory
    mkdir -p $pkgdir/usr/share/licenses/$pkgname
    find "$srcdir" -maxdepth 2 -type f -name 'LICENSE*' -exec cp -t "$pkgdir/usr/share/licenses/$pkgname" {} +
    find "$srcdir" -maxdepth 1 -type f -name 'COPYING*' -exec cp -t "$pkgdir/usr/share/licenses/$pkgname" {} +
}


################################################################################
# #
# # skill-ovos-naptime
# #
# ################################################################################
# 
# SKILL_OVOS_NAPTIME_VERSION = 92ab0cbef48273148c706a1b6f52d1574adb476f
# SKILL_OVOS_NAPTIME_SITE = $(call github,OpenVoiceOS,skill-ovos-naptime,$(SKILL_OVOS_NAPTIME_VERSION))
# SKILL_OVOS_NAPTIME_SETUP_TYPE = setuptools
# SKILL_OVOS_NAPTIME_LICENSE_FILES = LICENSE
# 
# $(eval $(python-package))
# 



